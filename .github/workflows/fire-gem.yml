name: Fire-Gem AVIS Engine
on: [push, workflow_dispatch]

jobs:
  deploy-gem:
    runs-on: ubuntu-latest
    env:
      # Use '|' to treat your AVIS as a single block of text
      FIRE_GEM_CONFIG: |
        fire-gem-config:
          avis:
            loader: "fire-gem/fire-gem.sh"
            path: "./fire-gem/"
            executable: "fire-gem.exe"
            message_type: "hello_world"
          runtime:
            shell: "/bin/bash"
            action: "exec"

    steps:
      - name: Checkout Repository
        uses: actions/checkout@v4

      - name: Initialize Environment
        run: |
          mkdir -p fire-gem
          # Write the AVIS text back to a real file for the ASM to read
          echo "$FIRE_GEM_CONFIG" > fire-gem/fire-gem.yml
          chmod +x fire-gem/fire-gem.sh

      - name: Execute AVIS Loader
        run: ./fire-gem/fire-gem.sh
